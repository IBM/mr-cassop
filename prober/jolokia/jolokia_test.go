package jolokia

import (
	"github.com/onsi/gomega"
	"testing"
)

func TestCassandraNodeState(t *testing.T) {
	asserts := gomega.NewGomegaWithT(t)

	responseBodies := []struct {
		inputStr    []byte
		expectedStr []byte
	}{
		{
			inputStr:    []byte(`{"level":"debug","ts":"2022-04-01T10:30:02.106Z","caller":"jolokia/jolokia.go:103","msg":"[{\"request\":{\"mbean\":\"org.apache.cassandra.net:type=FailureDetector\",\"attribute\":[\"SimpleStates\",\"AllEndpointStates\"],\"type\":\"read\",\"target\":{\"env\":{"password":"somePassword123","user":"user1"},\"url\":\"service:jmx:rmi:\\/\\/\\/jndi\\/rmi:\\/\\/172.30.99.23:7199\\/jmxrmi\"}},\"stacktrace\":\"java.lang.Exception: Authentication error\\n\\tat org.jolokia.http.HttpRequestHandler.executeRequest(HttpRequestHandler.java:214)\\n\\tat org.jolokia.http.HttpRequestHandler.handlePostRequest(HttpRequestHandler.java:131)\\n\\tat org.jolokia.http.AgentServlet$3.handleRequest(AgentServlet.java:493)\\n\\tat org.jolokia.http.AgentServlet.handleSecurely(AgentServlet.java:383)\\n\\tat org.jolokia.http.AgentServlet.handle(AgentServlet.java:354)\\n\\tat org.jolokia.http.AgentServlet.doPost(AgentServlet.java:317)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:681)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:764)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\\n\\tat org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:687)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:359)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:889)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1743)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:750)\\n\",\"error_type\":\"java.lang.Exception\",\"error\":\"java.lang.Exception : Authentication error\",\"status\":403}]","version":"undefined"}`),
			expectedStr: []byte(`{"level":"debug","ts":"2022-04-01T10:30:02.106Z","caller":"jolokia/jolokia.go:103","msg":"[{\"request\":{\"mbean\":\"org.apache.cassandra.net:type=FailureDetector\",\"attribute\":[\"SimpleStates\",\"AllEndpointStates\"],\"type\":\"read\",\"target\":{\"env\":{"password":"***","user":"***"},\"url\":\"service:jmx:rmi:\\/\\/\\/jndi\\/rmi:\\/\\/172.30.99.23:7199\\/jmxrmi\"}},\"stacktrace\":\"java.lang.Exception: Authentication error\\n\\tat org.jolokia.http.HttpRequestHandler.executeRequest(HttpRequestHandler.java:214)\\n\\tat org.jolokia.http.HttpRequestHandler.handlePostRequest(HttpRequestHandler.java:131)\\n\\tat org.jolokia.http.AgentServlet$3.handleRequest(AgentServlet.java:493)\\n\\tat org.jolokia.http.AgentServlet.handleSecurely(AgentServlet.java:383)\\n\\tat org.jolokia.http.AgentServlet.handle(AgentServlet.java:354)\\n\\tat org.jolokia.http.AgentServlet.doPost(AgentServlet.java:317)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:681)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:764)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\\n\\tat org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:687)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:359)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:889)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1743)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:750)\\n\",\"error_type\":\"java.lang.Exception\",\"error\":\"java.lang.Exception : Authentication error\",\"status\":403}]","version":"undefined"}`),
		},
		{
			inputStr:    []byte(`{"level":"debug","ts":"2022-04-01T10:30:02.106Z","caller":"jolokia/jolokia.go:103","msg":"[{\"request\":{\"mbean\":\"org.apache.cassandra.net:type=FailureDetector\",\"attribute\":[\"SimpleStates\",\"AllEndpointStates\"],\"type\":\"read\",\"target\":{\"env\":{"password":"sdo^%&sd4.,d!-","user":"someUser"},\"url\":\"service:jmx:rmi:\\/\\/\\/jndi\\/rmi:\\/\\/172.30.99.23:7199\\/jmxrmi\"}},\"stacktrace\":\"java.lang.Exception: Authentication error\\n\\tat org.jolokia.http.HttpRequestHandler.executeRequest(HttpRequestHandler.java:214)\\n\\tat org.jolokia.http.HttpRequestHandler.handlePostRequest(HttpRequestHandler.java:131)\\n\\tat org.jolokia.http.AgentServlet$3.handleRequest(AgentServlet.java:493)\\n\\tat org.jolokia.http.AgentServlet.handleSecurely(AgentServlet.java:383)\\n\\tat org.jolokia.http.AgentServlet.handle(AgentServlet.java:354)\\n\\tat org.jolokia.http.AgentServlet.doPost(AgentServlet.java:317)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:681)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:764)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\\n\\tat org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:687)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:359)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:889)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1743)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:750)\\n\",\"error_type\":\"java.lang.Exception\",\"error\":\"java.lang.Exception : Authentication error\",\"status\":403}]","version":"undefined"}`),
			expectedStr: []byte(`{"level":"debug","ts":"2022-04-01T10:30:02.106Z","caller":"jolokia/jolokia.go:103","msg":"[{\"request\":{\"mbean\":\"org.apache.cassandra.net:type=FailureDetector\",\"attribute\":[\"SimpleStates\",\"AllEndpointStates\"],\"type\":\"read\",\"target\":{\"env\":{"password":"***","user":"***"},\"url\":\"service:jmx:rmi:\\/\\/\\/jndi\\/rmi:\\/\\/172.30.99.23:7199\\/jmxrmi\"}},\"stacktrace\":\"java.lang.Exception: Authentication error\\n\\tat org.jolokia.http.HttpRequestHandler.executeRequest(HttpRequestHandler.java:214)\\n\\tat org.jolokia.http.HttpRequestHandler.handlePostRequest(HttpRequestHandler.java:131)\\n\\tat org.jolokia.http.AgentServlet$3.handleRequest(AgentServlet.java:493)\\n\\tat org.jolokia.http.AgentServlet.handleSecurely(AgentServlet.java:383)\\n\\tat org.jolokia.http.AgentServlet.handle(AgentServlet.java:354)\\n\\tat org.jolokia.http.AgentServlet.doPost(AgentServlet.java:317)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:681)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:764)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\\n\\tat org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:687)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:359)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:889)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1743)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:750)\\n\",\"error_type\":\"java.lang.Exception\",\"error\":\"java.lang.Exception : Authentication error\",\"status\":403}]","version":"undefined"}`),
		},
		{
			inputStr:    []byte(`{"level":"debug","ts":"2022-04-01T10:30:02.106Z","caller":"jolokia/jolokia.go:103","msg":"[{\"request\":{\"mbean\":\"org.apache.cassandra.net:type=FailureDetector\",\"attribute\":[\"SimpleStates\",\"AllEndpointStates\"],\"type\":\"read\",\"target\":{\"env\":{"user":"user","password":"password"},\"url\":\"service:jmx:rmi:\\/\\/\\/jndi\\/rmi:\\/\\/172.30.99.23:7199\\/jmxrmi\"}},\"stacktrace\":\"java.lang.Exception: Authentication error\\n\\tat org.jolokia.http.HttpRequestHandler.executeRequest(HttpRequestHandler.java:214)\\n\\tat org.jolokia.http.HttpRequestHandler.handlePostRequest(HttpRequestHandler.java:131)\\n\\tat org.jolokia.http.AgentServlet$3.handleRequest(AgentServlet.java:493)\\n\\tat org.jolokia.http.AgentServlet.handleSecurely(AgentServlet.java:383)\\n\\tat org.jolokia.http.AgentServlet.handle(AgentServlet.java:354)\\n\\tat org.jolokia.http.AgentServlet.doPost(AgentServlet.java:317)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:681)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:764)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\\n\\tat org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:687)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:359)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:889)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1743)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:750)\\n\",\"error_type\":\"java.lang.Exception\",\"error\":\"java.lang.Exception : Authentication error\",\"status\":403}]","version":"undefined"}`),
			expectedStr: []byte(`{"level":"debug","ts":"2022-04-01T10:30:02.106Z","caller":"jolokia/jolokia.go:103","msg":"[{\"request\":{\"mbean\":\"org.apache.cassandra.net:type=FailureDetector\",\"attribute\":[\"SimpleStates\",\"AllEndpointStates\"],\"type\":\"read\",\"target\":{\"env\":{"user":"***","password":"***"},\"url\":\"service:jmx:rmi:\\/\\/\\/jndi\\/rmi:\\/\\/172.30.99.23:7199\\/jmxrmi\"}},\"stacktrace\":\"java.lang.Exception: Authentication error\\n\\tat org.jolokia.http.HttpRequestHandler.executeRequest(HttpRequestHandler.java:214)\\n\\tat org.jolokia.http.HttpRequestHandler.handlePostRequest(HttpRequestHandler.java:131)\\n\\tat org.jolokia.http.AgentServlet$3.handleRequest(AgentServlet.java:493)\\n\\tat org.jolokia.http.AgentServlet.handleSecurely(AgentServlet.java:383)\\n\\tat org.jolokia.http.AgentServlet.handle(AgentServlet.java:354)\\n\\tat org.jolokia.http.AgentServlet.doPost(AgentServlet.java:317)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:681)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:764)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:227)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:189)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:162)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:197)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:541)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:135)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\\n\\tat org.apache.catalina.valves.AbstractAccessLogValve.invoke(AbstractAccessLogValve.java:687)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:359)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:889)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1743)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)\\n\\tat org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:750)\\n\",\"error_type\":\"java.lang.Exception\",\"error\":\"java.lang.Exception : Authentication error\",\"status\":403}]","version":"undefined"}`),
		},
	}

	for _, responseBody := range responseBodies {
		modifiedResponse := testRegExp(responseBody.inputStr)
		asserts.Expect(modifiedResponse).To(gomega.Equal(string(responseBody.expectedStr)))
	}

}

func testRegExp(data []byte) string {
	responseBodyModified := userRegExp.ReplaceAllString(string(data), `$1"***"`)
	responseBodyModified = passRegExp.ReplaceAllString(responseBodyModified, `$1"***"`)
	return responseBodyModified
}
